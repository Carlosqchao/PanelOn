<form #editForm="ngForm" (ngSubmit)="onSubmit(editForm)">
  <div class="aside-img">
    <img [src]="cover" alt="Comic Cover">
  </div>
  <div class="form-container">
    <div class="inner-form-container">
      <div style="align-self: flex-start;">
        <nav aria-label="Go back">
          <a id="back-link" href="#" onclick="history.back(); return false" style="color: black"> ← Go back</a>
        </nav>
      </div>

      <div class="title">
        <input
          type="text"
          name="title"
          placeholder="Title"
          [(ngModel)]="title"
          #titleInput="ngModel"
          required
          [ngClass]="{ 'invalid': !isValidTitle() && titleInput.touched }"
        >
        <div *ngIf="!isValidTitle() && formSubmitted" class="error-message">
          Invalid title. Only letters, numbers, and common punctuation allowed. Length: 2–50 chars.
        </div>
      </div>

      <div class="title">
        <input
          type="text"
          id="author"
          name="author"
          placeholder="Author"
          [(ngModel)]="author"
          #authorInput="ngModel"
          required
          [ngClass]="{ 'invalid': !isValidAuthor() && authorInput.touched }"
        >
        <div *ngIf="!isValidAuthor() && formSubmitted" class="error-message">
          Invalid author. Only letters, numbers, and common punctuation allowed. Length: 2–50 chars.
        </div>
      </div>

      <div class="title">
        <textarea id="synopsis" [(ngModel)]="synopsis" name="synopsis" placeholder="Synopsis" rows="4" cols="50"></textarea>
      </div>

      <div class="state-container">
        <select id="state" [(ngModel)]="state" name="state" required>
          <option value="" disabled>Select State</option>
          <option *ngFor="let stateOption of stateOptions" [value]="stateOption">{{ stateOption }}</option>
        </select>
        <div *ngIf="formSubmitted && state === ''" class="error-message">
          Please select a state.
        </div>
      </div>

      <div class="genre-container">
        <select
          id="genre"
          [(ngModel)]="selectedGenre"
          name="selectedGenre"
          [ngClass]="{ 'invalid': selectedGenres.length === 0 && formSubmitted }"
        >
          <option value="" disabled selected>Select Genre</option>
          <option *ngFor="let genre of genre" [value]="genre">{{ genre }}</option>
        </select>
        <button type="button" (click)="addGenre()">Add</button>
      </div>

      <div class="genre-list">
        <p>Selected Genres (click to remove):</p>
        <span
          *ngFor="let genre of selectedGenres"
          class="genre-item"
          (click)="removeGenre(genre)"
          style="cursor: pointer; margin-right: 8px;"
        >
          {{ genre }}
          <i class="fas fa-times" style="margin-left: 4px; color: red;"></i>
        </span>
      </div>

      <div *ngIf="selectedGenres.length === 0 && formSubmitted" class="error-message">
        Please select at least one genre.
      </div>

      <div *ngIf="updateSuccess" class="message success-message">
        ✅ Update Successful!
      </div>

      <div *ngIf="updateError" class="message error-message">
        ⚠️ There was an error during the update.
      </div>

      <div class="upload-button">
        <app-button text="SAVE CHANGES"></app-button>
      </div>
    </div>
  </div>
</form>
